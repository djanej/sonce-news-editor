<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Modal Test - Sonce News Editor</title>
	<link rel="stylesheet" href="style.css">
	<style>
		.status { padding: 12px; border-radius: 8px; margin: 12px 0; }
		.status.success { background: #dcfce7; color: #166534; border: 1px solid #22c55e; }
		.status.error { background: #fee2e2; color: #991b1b; border: 1px solid #ef4444; }
		.status.info { background: #dbeafe; color: #1e40af; border: 1px solid #3b82f6; }
		.test-buttons { display: flex; gap: 12px; margin: 20px 0; flex-wrap: wrap; }
		.test-buttons button { padding: 12px 20px; border-radius: 8px; border: 2px solid #334155; background: #0b1220; color: #e5e7eb; cursor: pointer; }
		.test-buttons button:hover { background: #1e293b; }
		.test-buttons button.emergency { background: #dc2626; color: white; border-color: #dc2626; }
		.test-buttons button.emergency:hover { background: #b91c1c; }
	</style>
</head>
<body>
	<main style="max-width: 800px; margin: 40px auto; padding: 20px; font-family: system-ui, -apple-system, sans-serif;">
		<h1>üîß Modal Test - Sonce News Editor</h1>
		
		<div class="status info">
			<strong>If you're seeing a modal popup that says "Modal" and can't close it:</strong>
			<ol style="margin: 12px 0; padding-left: 20px;">
				<li>Try the <strong>Emergency Kill</strong> button below</li>
				<li>Use <strong>Ctrl+Shift+M</strong> keyboard shortcut</li>
				<li>Press <strong>Escape</strong> key</li>
				<li>Open browser console and type: <code>emergencyKillModal()</code></code></li>
			</ol>
		</div>

		<h2>Modal Status Check</h2>
		<p>This page tests if the modal popup issue has been fixed.</p>
		
		<div class="test-buttons">
			<button onclick="checkModal()">Check Modal Status</button>
			<button onclick="forceCloseModal()">Force Close Modal</button>
			<button onclick="killModal()">Destroy Modal Completely</button>
			<button onclick="emergencyKillModal()" class="emergency">üö® EMERGENCY KILL</button>
		</div>

		<div id="status"></div>

		<h2>Modal Controls</h2>
		<p>Use these shortcuts to control the modal:</p>
		<ul>
			<li><strong>Ctrl+Shift+M</strong> - Force close modal</li>
			<li><strong>Escape</strong> - Close modal (if visible)</li>
			<li><strong>emergencyKillModal()</strong> - Console command to kill modal</li>
		</ul>

		<h2>Test Modal Functionality</h2>
		<button onclick="testOpenModal()">Test Open Modal</button>
		<button onclick="testOpenModalWithContent()">Test Modal with Content</button>
	</main>

	<div id="modal-overlay" class="modal-overlay" hidden>
		<div class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
			<div class="modal-header">
				<h3 id="modal-title">Test Modal</h3>
				<button type="button" id="modal-close" aria-label="Close modal">√ó</button>
			</div>
			<div id="modal-body" class="modal-body">
				<p>This is a test modal to verify functionality.</p>
				<button onclick="closeModal()">Close Modal</button>
			</div>
		</div>
	</div>

	<script>
		// Emergency modal killer - available immediately
		window.emergencyKillModal = function() {
			const modal = document.getElementById('modal-overlay');
			if (modal) {
				modal.hidden = true;
				modal.style.display = 'none';
				modal.setAttribute('data-force-hide', 'true');
				console.log('EMERGENCY: Modal killed immediately');
				checkModal();
				return true;
			}
			console.log('No modal found to kill');
			return false;
		};

		function checkModal() {
			const status = document.getElementById('status');
			const modal = document.getElementById('modal-overlay');
			
			if (!modal) {
				status.innerHTML = '<div class="status error">‚ùå Modal element not found</div>';
				return;
			}
			
			const isHidden = modal.hidden || modal.style.display === 'none' || modal.hasAttribute('data-force-hide');
			
			if (isHidden) {
				status.innerHTML = '<div class="status success">‚úÖ Modal is properly hidden</div>';
			} else {
				status.innerHTML = '<div class="status error">‚ùå Modal is visible - this is the problem!</div>';
			}
		}

		function forceCloseModal() {
			if (window.forceCloseModal) {
				window.forceCloseModal();
				checkModal();
			} else {
				document.getElementById('status').innerHTML = '<div class="status error">‚ùå forceCloseModal function not available</div>';
			}
		}

		function killModal() {
			if (window.killModal) {
				window.killModal();
				checkModal();
			} else {
				document.getElementById('status').innerHTML = '<div class="status error">‚ùå killModal function not available</div>';
			}
		}

		function closeModal() {
			const modal = document.getElementById('modal-overlay');
			if (modal) {
				modal.hidden = true;
			}
		}

		function testOpenModal() {
			const modal = document.getElementById('modal-overlay');
			if (modal) {
				modal.hidden = false;
				modal.style.display = 'grid';
				modal.removeAttribute('data-force-hide');
				checkModal();
			}
		}

		function testOpenModalWithContent() {
			const modal = document.getElementById('modal-overlay');
			const title = document.getElementById('modal-title');
			const body = document.getElementById('modal-body');
			
			if (modal && title && body) {
				title.textContent = 'Test Modal with Content';
				body.innerHTML = '<p>This modal has proper content and should work correctly.</p><button onclick="closeModal()">Close</button>';
				modal.hidden = false;
				modal.style.display = 'grid';
				modal.removeAttribute('data-force-hide');
				checkModal();
			}
		}

		// Set up close button
		document.addEventListener('DOMContentLoaded', () => {
			const closeBtn = document.getElementById('modal-close');
			if (closeBtn) {
				closeBtn.addEventListener('click', closeModal);
			}
			
			// Add keyboard shortcuts
			document.addEventListener('keydown', (e) => {
				if (e.key === 'Escape') {
					closeModal();
					checkModal();
				}
				if (e.ctrlKey && e.shiftKey && e.key === 'M') {
					e.preventDefault();
					emergencyKillModal();
				}
			});
		});

		// Check modal status on page load
		document.addEventListener('DOMContentLoaded', () => {
			setTimeout(checkModal, 1000);
		});

		// Try to kill modal immediately if it exists
		if (document.getElementById('modal-overlay')) {
			emergencyKillModal();
		}
	</script>
</body>
</html>